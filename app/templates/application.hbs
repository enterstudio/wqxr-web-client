{{#if model.splashPage}}
  {{django-page page=model.splashPage.pagecontent}}
{{/if}}

{{#if chromeDisabled}}
  {{outlet}}
{{else if miniChrome}}
  {{#nypr-mini-chrome promo='Tune in Mondayâˆ’Thursday at 8 p.m. ET'}}
    {{outlet}}
  {{/nypr-mini-chrome}}
{{else}}
  {{#site-chrome headerDonateChunk=headerDonateChunk isHomepage=isHomepage currentPath=currentPath showPlayer=showPlayer}}
    {{outlet}}
  {{/site-chrome}}
{{/if}}

{{#nypr-player-integration as |integration|}}
  {{#liquid-if showPlayer class="nypr-player-wrapper"}}

    {{#liquid-if integration.revealNotificationBar class='player-notification-wrapper'}}
      {{#player-notification onDismiss=integration.onDismissNotification}}
        {{player-notification/autoplay-message
          duration   = audio.duration
          position   = audio.position
          audioType  = currentAudio.audioType
          isLoggedIn = session.isAuthenticated
        }}
      {{/player-notification}}
    {{/liquid-if}}

    {{#liquid-if showShareBar class="player-share-wrapper"}}
      {{player-share-bar
          onDismiss = (action 'closeShareBar')
      }}
    {{/liquid-if}}

    {{#nypr-player
      onPlay=integration.onPlay
      onPause=integration.onPause
      onFastForward=integration.onFastForward
      onRewind=integration.onRewind
      onSetPosition=integration.onSetPosition
      currentTitle=integration.currentTitle
      backdropImageUrl=integration.backdropImageUrl
      storyTitle=integration.storyTitle
      showTitle=integration.showTitle
      as |content|}}

        {{#content.for 'trackInfo'}}
          {{nypr-player-integration/track-info
            currentAudio    = integration.currentAudio
            showTitle       = integration.showTitle
            showUrl         = integration.showUrl
            storyTitle      = integration.storyTitle
            storyUrl        = integration.storyUrl
            audioId         = integration.audioId
            songDetails     = integration.songDetails
            isStream        = integration.isStream
            trackStreamData = (action 'trackStreamData')
          }}
        {{/content.for}}

        {{#content.for 'streamInfo'}}
          {{nypr-player-integration/stream-info
            streamScheduleUrl = integration.streamScheduleUrl
            streamPlaylistUrl = integration.streamPlaylistUrl
            streamUrl         = integration.streamUrl
            streamName        = integration.streamName
          }}
        {{/content.for}}

        
        {{#unless media.isLargeAndUp}}
          {{#unless hifi.isLoading}} {{! only show the share button when the audio has loaded}}
            {{#if integration.currentAudio.shareMetadata}}
              {{#content.for 'shareButton' as |args|}}
              {{args.shareButton
                story  = integration.currentAudio
                type   = (if integration.isStream 'stream' 'ondemand')
                openShareBar = (action 'openShareBar')
                closeShareBar = (action 'closeShareBar')
                isShareOpen = showShareBar
                }}
              {{/content.for}}
            {{/if}}
          {{/unless}}
        {{else}}
          {{#content.for 'queueButton' as |args|}}
            {{args.queueButton
              queueLength = audio.queue.items.length
              showModal   = (action 'showModal' 'queue-history')
              closeModal  = (action 'closeModal')
              isOpenModal = modal}}
            {{/content.for}}
        {{/unless}}
        
    {{/nypr-player}}
  {{/liquid-if}}
{{/nypr-player-integration}}
{{#liquid-if modal class="modal-wrapper sliding-modal"}}
  {{#x-modal closeModal=(action 'closeModal')}}
    {{component modal}}
  {{/x-modal}}
{{/liquid-if}}
